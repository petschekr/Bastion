<link rel="import" href="../bower_components/polymer/polymer.html" />
<link rel="import" href="../bower_components/neon-animation/neon-animated-pages.html" />
<link rel="import" href="../bower_components/neon-animation/neon-animations.html" />
<link rel="import" href="../bower_components/neon-animation/neon-animatable.html" />
<link rel="import" href="../components/bastion-main.html" />
<link rel="import" href="../components/bastion-key.html" />

<dom-module id="bastion-wrapper">
	<style>
		:host {
			display: block;
		}
		neon-animated-pages {
			height: 100%;
		}
	</style>
	
	<template>
		<neon-animated-pages id="pages" class="flex" selected="0" entry-animation="[[entryAnimation]]" exit-animation="[[exitAnimation]]" on-neon-animation-finish="animationDone">
			<neon-animatable>
				<bastion-main></bastion-main>
			</neon-animatable>
			<neon-animatable>
				<bastion-key></bastion-key>
			</neon-animatable>
		</neon-animated-pages>
	</template>
	
	<script>
		Polymer({
			is: "bastion-wrapper",
			ready: function() {
				window.bastionWrapper = this;
			},
			goToKeyDetail: function(keyToImport) {
				this.entryAnimation = "slide-from-right-animation";
				this.exitAnimation = "slide-left-animation";
				this.$.pages.selected = 1;
				this.keyToImport = keyToImport;
				this.$$("bastion-key").spinner(true);
			},
			goToMain: function() {
				this.entryAnimation = "slide-from-left-animation";
				this.exitAnimation = "slide-right-animation";
				this.$.pages.selected = 0;
			},
			animationDone: function() {
				if (this.$.pages.selected === 1) {
					this.$$("bastion-key").loadKey(this.keyToImport);
				}
			}
		});
	</script>
</dom-module>